var http = require('http');
var parseString = require('xml2js').parseString;

exports.CheckCarRegistrationIndia = function(RegistrationNumber,username,callback){
  getHttp("www.regcheck.org.uk",
    "/api/reg.asmx/CheckIndia?RegistrationNumber="+RegistrationNumber
    +"&username=" + username,
    function(data){
    parseString(data,function(err,result){
      var innerJson = result.Vehicle.vehicleJson;
      var oInnerJson = JSON.parse(innerJson);
      callback(oInnerJson);
    });
  });
}

function getHttp(host,path,callback) {
  return http.get({
    host: host,
    path: path
  }, function(response) {
    // Continuously update stream with data
    var body = "";
      response.on('data', function(d) {
      body += d;
    });
    response.on('end', function() {
      callback(body);
    });
  });
}
